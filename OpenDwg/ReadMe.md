# OpenDwg

## Открытие файлов чертежей не в графическом редакторе средствами `Multicad`, `AutoCAD` vs `nanoCAD` ( *Teigha*)

- Multicad - открытие файла в скрытом режиме `hiden`

- AutoCAD (nanoCAD ) - открытие как базы чертежа `ReadDwgFile`

Открыть файл:
- Teigha - сделать файл рабочим и закрыть ничего не меняя
- Multicad -открыть закрыть в `McDocumentsManager`.

Результат:
- (Opening, Working, Closed) в лог файлы рядом со сборкой
- Ошибки в лог файлы рядом со сборкой

---

## Смысл = ТЕСТ:
- скорости открытия
- корректности открытия
- вылеты кадов
- невозможность открытия
- утечки памяти (>3000 файлов nanoCAD вешает систему, затем падает сам)


*PS мож чего еще допишу*

# Результаты 

тест: отрыть прочитать закрыть 
4000 разношерстных файлов с мультикад объектами

тестовый код идентичный в обоих кадах

- Multicad - открываем документ в скрытом режиме\
`mcDocument = McDocumentsManager.OpenDocument(file, false, true);`
- Teigha - открываем файл как базу чертежа\
 `extDBase.ReadDwgFile(file, Db.FileOpenMode.OpenForReadAndAllShare, false, "");`


Результат получился немного неожиданным


|CAD|Reader|Всего|Прочитано|Ошибок|Время|Примечание|
|---|---|---|---|---|---|---|
|AutoCAD|Teigha|4000|4000|0|00:08:17.3445218||
|nanoCAD|Teigha|4000|4000|0|<b>00:06:19.6759072</b> ||
|AutoCAD|MultiCad|4000|4000|0|<b>00:04:39.5789037</b>|MC|
|AutoCAD|MultiCad|4000|4000|0|<b>00:04:50.1422993</b>|MCDI|
|nanoCAD|MultiCad|4000|4000|0|00:28:25.9152691|MCDI|
|nanoCAD|Teigha->MultiCad|4000|3994|6|00:06:43.1897441|TGMC 6 файлов не открыл|

т.е. nanoCAD обыграл оригинал на чужом поле Teigha и вчистую слил на своем в Multicad

Более того, без шаманства nanoCAD напрочь отказывался обрабатывать много много файлов в Multicad`е
в классе `MC` после ~3500 файлов виснет
в классе `MCDI`, `MCD` после ~3500 файлов вешает машину, но работу продолжает

пришлось подставлять костыли в виде

```
 mcDocument.Dispose(); //todo костыль
 ```
 ---

в классе `TGMC` получаем базу чертежа средствами Teigha `ReadDwgFile` затем перекидываем в Multicad,\
 наиболее приемлемый результат по времени, но 6 файлов ReadDwgFile хоть и были прочитаны, \
 `mcDocument = McDocumentsManager.GetDocument(file);` вернул null, \
 на этих же чертежах АК отработал четко.



